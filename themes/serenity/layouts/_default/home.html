{{ define "main" }}
  <!-- Main Content Section -->
  <div class="mx-auto max-w-7xl px-6 lg:px-8 py-16">
    {{ .Content }}
  </div>

  <!-- Blog Section -->
  <div class="bg-white py-24 sm:py-32">
    <div class="mx-auto max-w-7xl px-6 lg:px-8">
      <!-- Blog Header -->
      <div class="mx-auto max-w-2xl lg:mx-0">
        <h2 class="font-mono text-xs tracking-widest text-gray-500 font-medium uppercase">Latest Updates</h2>
        <p class="mt-6 text-3xl font-light tracking-tight text-balance sm:text-4xl text-gray-900">
          News and Insights from <span class="text-sky-600 font-normal">Our Team</span>
        </p>
        <p class="mt-6 text-base text-gray-600 max-w-xl">
          Stay informed about the latest developments in home security and privacy technology.
        </p>
      </div>

      <!-- Blog Posts Grid -->
      <div class="mx-auto mt-16 grid max-w-2xl gap-x-8 gap-y-12 lg:mx-0 lg:max-w-none lg:grid-cols-3">
        {{ range first 3 (where .Site.RegularPages "Section" "posts") }}
          <article class="group relative">
            <!-- Image Container -->
            <div class="relative w-full aspect-[16/9] overflow-hidden rounded-2xl bg-gray-100 mb-8">
              {{/* Check for page resources first */}}
              {{ $image := "" }}
              {{ with .Resources.GetMatch "*.jpg" }}
                {{ $image = . }}
              {{ else }}
                {{ with .Resources.GetMatch "*.png" }}
                  {{ $image = . }}
                {{ else }}
                  {{ with .Params.image }}
                    {{ $image = . }}
                  {{ end }}
                {{ end }}
              {{ end }}

              {{ with $image }}
                {{ if reflect.IsMap . }}
                  {{/* This is a page resource */}}
                  {{ $img := .Resize "800x450 webp" }}
                  <img 
                    src="{{ $img.RelPermalink }}" 
                    alt="{{ $.Title }}" 
                    class="absolute inset-0 h-full w-full object-cover"
                  >
                {{ else }}
                  {{/* This is a static image path */}}
                  <img 
                    src="{{ . }}" 
                    alt="{{ $.Title }}" 
                    class="absolute inset-0 h-full w-full object-cover"
                  >
                {{ end }}
              {{ else }}
                <!-- Placeholder gradient if no image -->
                <div class="absolute inset-0 bg-gradient-to-br from-sky-50 from-28% via-sky-100/70 to-sky-100/40"></div>
              {{ end }}
            </div>

            <!-- Meta info -->
            <div class="flex items-center gap-x-4 text-xs">
              <time datetime="{{ .Date.Format "2006-01-02" }}" class="text-gray-500">
                {{ .Date.Format "Jan 02, 2006" }}
              </time>
              {{ with .Params.category }}
                <a 
                  href="/categories/{{ . | urlize }}" 
                  class="relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-100"
                >
                  {{ . }}
                </a>
              {{ end }}
            </div>

            <!-- Title and Summary -->
            <div class="relative mt-4">
              <h3 class="text-xl font-medium tracking-tight text-gray-900 group-hover:text-sky-600 transition">
                <a href="{{ .RelPermalink }}">
                  <span class="absolute inset-0"></span>
                  {{ .Title }}
                </a>
              </h3>
              <p class="mt-4 text-base text-gray-600 line-clamp-3">
                {{ .Summary }}
              </p>
            </div>

            <!-- Author info if available -->
            {{ with .Params.author }}
              <div class="relative mt-8 flex items-center gap-x-4">
                {{ with .image }}
                  <img 
                    src="{{ . }}" 
                    alt="{{ $.Params.author.name }}" 
                    class="size-10 rounded-full bg-gray-50"
                  >
                {{ else }}
                  <div class="size-10 rounded-full bg-gray-50 flex items-center justify-center text-gray-400">
                    <svg class="size-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                  </div>
                {{ end }}
                <div class="text-sm/6">
                  <p class="font-medium text-gray-900">{{ .name }}</p>
                  {{ with .title }}
                    <p class="text-gray-600">{{ . }}</p>
                  {{ end }}
                </div>
              </div>
            {{ end }}
          </article>
        {{ end }}
      </div>

      <!-- View All Posts Link -->
      <div class="mt-16 text-center">
        <a href="/blog" class="inline-flex items-center text-sm font-semibold text-sky-600 gap-2 group">
          View all posts
          <svg class="w-4 h-4 transition group-hover:translate-x-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12h15m0 0l-6.75-6.75M19.5 12l-6.75 6.75" />
          </svg>
        </a>
      </div>
    </div>
  </div>
{{ end }}
